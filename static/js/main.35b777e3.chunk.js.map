{"version":3,"sources":["components/DocsCard/DocsCard.tsx","components/Editor.tsx","components/EditableText.tsx","components/Sidebar.tsx","components/FlowCard.tsx","components/CardHStack.tsx","App.tsx","reportWebVitals.ts","serviceWorker.ts","theme.ts","index.tsx","components/TypeBadge.tsx","components/DocsCard/components.tsx","state.ts","components/PopoverExplanation.tsx"],"names":["hasCommandModifier","KeyBindingUtil","useCallback","React","autocompleteKeyBindingFn","e","key","getDefaultKeyBinding","defaultName","typeSuggestions","title","safeEval","s","eval","error","getParamsAndReturns","split","arrow","map","type","trim","isSignatureCorrect","paramsAndReturns","length","every","p","includes","getFilteredTypeSuggestions","typeSuggestions_","inputValue","undefined","some","matchSorter","keys","getFilteredFunctions","functions","typeToName","x","n","suffix","getParamNames","arr","result","alreadySeenTypes","forEach","iType","paramName","push","findWithRegex","regex","contentBlock","callback","matchArr","start","text","getText","exec","index","signatureDecorator","CompositeDecorator","strategy","cb","contentState","RegExp","join","component","props","typeAsString","decoratedText","children","as","HANDLE_REGEX","getStateValueFromFunc","descriptionDecorator","func","name","signature","EditorState","createWithContent","ContentState","createFromText","parameters","concat","returns","description","code","fn","toString","setOriginalState","originalState","state","newOriginalState","signatureString","getCurrentContent","getPlainText","descriptionString","current","DocsCard","dispatch","navigationType","rest","variant","color","fontSize","fontStyle","style","direction","unicodeBidi","data-offset-key","offsetKey","onClick","openerIndex","fnName","slice","setState","previousFunc","setPreviousFunc","closeButtonRef","scrollIntoView","behavior","onChangeName","nameFontStyle","nameColor","descriptionHasText","hasText","descriptionFontStyle","descriptionColor","onChangeDescription","window","requestAnimationFrame","selection","getSelection","rangeCount","stateSelection","block","getBlockForKey","getStartKey","getHasFocus","getEntityAt","getStartOffset","wholeWordText","getRangeAt","startContainer","textContent","lastIndexOf","substring","tempRange","cloneRange","setStart","rangeRect","getBoundingClientRect","left","bottom","setAutocompleteDescription","top","startIndex","selectedIndex","autocompleteDescription","filteredFunctions","descriptionEditorRef","handleDescriptionKeyCommand","command","clickIndex","filteredSuggestions","blur","currentSelectionState","anchorOffset","getAnchorOffset","anchorKey","getAnchorKey","currentContent","blockText","textToInsert","entityKey","createEntity","getLastCreatedEntityKey","mentionTextSelection","merge","focusOffset","insertingContent","Modifier","replaceText","editorStateWithEntity","signatureEditorRef","signatureEditorParentRef","coordsSignatureEditor","onChangeSignatureEditor","newEditorState","getLastChangeType","getFirstBlock","newText","endsWith","previousMeaningfulCharIsArrow","replace","trimEnd","previousCharIsClosingBracket","substr","moveFocusToEnd","range","editorParent","coords","setAutocompleteSignature","autocompleteSignature","params","paramNames","editorValue","signatureError","hasChanges","onClearButtonClick","backgroundColor","padding","minHeight","display","flexDirection","paddingLeft","alignItems","fadeIn","validParams","pop","function","disabled","aria-label","icon","size","ref","sx","scrollMarginRight","marginTop","droppableId","provided","snapshot","innerRef","droppableProps","flex","height","overflow","paddingX","paddingY","value","onChange","placeholder","textColor","marginBottom","width","_focus","outline","editorState","keyBindingFn","handleKeyCommand","className","functionSuggestions","_","v","onChangeCode","Editor","language","theme","options","minimap","enabled","lineNumbers","EditableText","forwardRef","FunctionItem","wrap","_hover","rounded","flexWrap","i","TypeBadge","ArrowForward","marginX","getFunctionRenderItem","rubric","draggableProps","dragHandleProps","useTreeItemStyles","makeStyles","root","content","cursor","FunctionTreeItem","TreeItem","classes","isAnyItemDragging","nodeId","label","renderClone","isDropDisabled","shouldRenderClone","draggingFromThisWith","draggableId","TypeTreeItem","Sidebar","items","searchValue","useTheme","colors","unison","purple","lightPurple","aqua","isHoveringSearch","setIsHoveringSearch","isFocusedSearch","setFocusedSearch","onMouseEnterSearch","onMouseLeaveSearch","paddingTop","whiteSpace","onMouseEnter","onMouseLeave","pointerEvents","Search","borderBottomColor","focusBorderColor","borderRadius","borderTop","borderLeft","borderRight","borderBottom","onFocus","setSelectionRange","onBlur","target","background","position","right","PopoverExplanation","TreeView","selected","defaultCollapseIcon","ChevronDown","defaultExpandIcon","ChevronRight","onNodeFocus","draggable","document","querySelector","querySelectorAll","classList","remove","div","parentElement","li","parentMenu","previous","previousElementSibling","next","nextElementSibling","bound","MouseTrap","bind","focus","add","item","fontWeight","innerItem","id","TypeAndValue","justifyContent","isNaN","Number","allowMouseWheel","colorScheme","isChecked","checked","C_TypeAndValue","fnId","paramIndex","noInput","ParameterContext","fns","setFns","find","param","findIndex","previousFns","newValues","previousReturn","newItems","previouslastParam","returnValue","console","log","getParamValues","FlowFunctionView","isFirstFunctionInFlow","hasZeroParams","hasOneParam","templateColumns","gap","justifySelf","css","transform","ArrowDown","getFnsValuesFromItems","previousItems","pi","err","FlowFunctionsList","setPreviousItems","previousValues","Provider","in","FlowCard","boxShadow","leftIcon","Delete","useContext","CardHStack","scrollContainerRef","flowCardRef","boxShadows","setBoxShadows","offsetWidth","listener","scrollAmount","scrollLeft","newBoxShadows","Math","ceil","scrollContainer","addEventListener","removeEventListener","StateContext","overflowX","overflowY","flexGrow","spacing","docCards","flex-grow","transition","flowCardFunctions","flexShrink","docCardsNavigationType","docCardsSelectedIndex","doc","f","Add","App","useAppReducer","onDragEnd","dropResult","source","destination","sourceIndex","destinationIndex","sideBarRef","useToken","keyMap","focusSidebar","handlers","onDragStart","defaultSize","minSize","maxSize","pane2Style","isSideBarItemDragging","dataTypes","effects","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","Boolean","location","hostname","match","extendTheme","styles","global","html","minWidth","number","bool","shadows","limegreen","green","yellow","orange","pink","lightblue","blue","darkblue","gray","darkOrange","darkGreen","darkPink","ReactDOM","render","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","message","string","boolean","object","array","null","SaveButton","ClearButton","DocsExplanation","styleType","href","TypeSuggestionList","listStyleType","zIndex","textAlign","FunctionSuggestionList","DocsNavigationTypeSelector","getButtonStyles","isDisabled","DocsNavigationArrows","backDisabled","forwardDisabled","to","w","h","margin","initialState","y","z","m","toUpperCase","reorder","list","endIndex","listCopy","splice","removed","insert","changeAtIndex","getDefaultValue","findFunction","incrementWithinBounds","decrementPositiveNumber","reducer","action","fnIndex","sort","a","b","localeCompare","uuid","d","filter","hasArrow"],"mappings":"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","file":"static/js/main.35b777e3.chunk.js","sourcesContent":["import * as React from 'react'\nimport {\n  HStack,\n  Editable,\n  EditablePreview,\n  EditableInput,\n  Text,\n  Code,\n  IconButton,\n  Box,\n  Divider,\n  Flex,\n  Heading,\n  Spacer,\n  Button,\n  Fade,\n  ChakraProps,\n} from '@chakra-ui/react'\nimport { CloseIcon, ArrowUpDownIcon } from '@chakra-ui/icons'\nimport MonacoEditor from '../Editor'\n\nimport { Itype, Ifunction } from '../interfaces'\nimport { matchSorter } from 'match-sorter'\nimport TypeBadge from '../TypeBadge'\nimport EditableText from '../EditableText'\nimport { Droppable } from 'react-beautiful-dnd'\nimport { Action, NavigationType } from '../../state'\nimport {\n  CompositeDecorator,\n  Editor as DraftEditor,\n  EditorState,\n  ContentState,\n  Entity,\n  Modifier,\n  ContentBlock,\n} from 'draft-js'\nimport 'draft-js/dist/Draft.css'\nimport './draftEditorStyles.css'\n// import SuggestionList from './autocomplete-react-draft/src/suggestions'\nimport { getDefaultKeyBinding, KeyBindingUtil } from 'draft-js'\nimport {\n  ClearButton,\n  DocsExplanation,\n  DocsNavigationArrows,\n  DocsNavigationTypeSelector,\n  FunctionSuggestionList,\n  SaveButton,\n  TypeSuggestionList,\n} from './components'\nconst { hasCommandModifier } = KeyBindingUtil\n\nconst { useCallback } = React\n\nconst autocompleteKeyBindingFn = (e: any): string | null => {\n  //TODO e type\n  switch (e.key) {\n    case 'ArrowDown':\n      return 'down'\n    case 'ArrowUp':\n      return 'up'\n    case 'Escape':\n      return 'close'\n    case 'Enter':\n      return 'select'\n    // case 'Tab':\n    //   return 'select'\n    default:\n      return getDefaultKeyBinding(e)\n  }\n}\n\nconst defaultName = 'name'\n// const defaultType = '_'\nconst typeSuggestions: Array<{ title: Itype['type'] /*| 'New type' */ }> = [\n  { title: 'string' },\n  { title: 'boolean' },\n  { title: 'number' },\n]\n\nconst safeEval = (s: string) => {\n  try {\n    return eval(`(() => ${s})()`)\n  } catch (error) {\n    return null\n  }\n}\nconst getParamsAndReturns = (s: string) =>\n  s.split(arrow).map(s => ({ type: s.trim() }))\n\nconst isSignatureCorrect = (\n  paramsAndReturns: Array<{ type: string }>,\n): paramsAndReturns is Array<Itype> =>\n  paramsAndReturns.length > 1 &&\n  paramsAndReturns.every(p => ['boolean', 'number', 'string'].includes(p.type))\n\nconst getFilteredTypeSuggestions = (\n  typeSuggestions_: typeof typeSuggestions,\n  inputValue?: string,\n) => {\n  if (inputValue === undefined || inputValue === null) return []\n  if (inputValue === '' || inputValue === ' ') return typeSuggestions\n  if (typeSuggestions.some(s => s.title === inputValue)) return []\n  return matchSorter(typeSuggestions_, inputValue, { keys: ['title'] })\n}\n\nconst getFilteredFunctions = (functions: Ifunction[], inputValue?: string) => {\n  if (inputValue === undefined || inputValue === null) return []\n  if (inputValue === '') return functions\n  return matchSorter(functions, inputValue, { keys: ['name'] })\n}\n\nconst arrow = '->'\n\nconst typeToName = (x: { type: string }, n: number): string => {\n  const suffix = n || ''\n  switch (x.type) {\n    case 'string':\n      return 'str' + suffix\n    case 'number':\n      return 'num' + suffix\n    case 'boolean':\n      return 'bool' + suffix\n    default:\n      return 'x'\n    // case 'function':\n    //   return ['f', 'g', 'h', 'i', 'j'][n]\n    // case 'object':\n    //   return 'o' + suffix\n\n    // case 'array':\n    //   return '' //TODO\n    // case 'undefined':\n    // case 'null':\n    //   return ''\n  }\n}\nconst getParamNames = (arr: Array<{ type: string }>): string[] => {\n  let result: string[] = []\n  let alreadySeenTypes: any = {}\n  arr.forEach(iType => {\n    const paramName = typeToName(iType, alreadySeenTypes[iType.type])\n    result.push(paramName)\n    alreadySeenTypes[iType.type] = (alreadySeenTypes[iType.type] || 0) + 1\n  })\n  return result\n}\n\nfunction findWithRegex(regex: any, contentBlock: ContentBlock, callback: any) {\n  const text = contentBlock.getText()\n  let matchArr, start\n  while ((matchArr = regex.exec(text)) !== null) {\n    start = matchArr.index\n    callback(start, start + matchArr[0].length)\n  }\n}\n\nconst signatureDecorator = new CompositeDecorator([\n  {\n    //TypeBadge\n    strategy(contentBlock, cb, contentState) {\n      findWithRegex(\n        new RegExp(\n          `(${typeSuggestions.map(({ title }) => title).join('|')})`,\n          'gi',\n        ),\n        contentBlock,\n        cb,\n      )\n    },\n    component(props: any) {\n      return (\n        <TypeBadge\n          typeAsString={props.decoratedText}\n          children={props.children}\n          as='span'\n        />\n      )\n    },\n  },\n])\n\nconst HANDLE_REGEX = /@[\\w]+/g\n\nconst getStateValueFromFunc = (\n  descriptionDecorator: CompositeDecorator,\n  func?: Ifunction,\n): {\n  name: string\n  signature: EditorState\n  description: EditorState\n  code: string\n} => {\n  return {\n    name: func?.name || '',\n    signature: EditorState.createWithContent(\n      ContentState.createFromText(\n        func?.parameters\n          .concat(func.returns)\n          .map(p => p.type)\n          .join(` ${arrow} `) || '',\n      ),\n      signatureDecorator,\n    ),\n    description: EditorState.createWithContent(\n      ContentState.createFromText(func?.description || ''),\n      descriptionDecorator,\n    ),\n    code: func?.fn.toString() || '',\n  }\n}\n\ntype DocsCardState = {\n  name: string\n  signature: EditorState\n  description: EditorState\n  code: string\n}\n\nconst setOriginalState = (\n  originalState: React.MutableRefObject<{\n    name: string\n    signatureString: string\n    descriptionString: string\n    code: string\n  }>,\n  state: DocsCardState,\n) => {\n  const newOriginalState = {\n    name: state.name,\n    signatureString: state.signature.getCurrentContent().getPlainText(),\n    descriptionString: state.description.getCurrentContent().getPlainText(),\n    code: state.code,\n  }\n\n  originalState.current = newOriginalState\n}\n\n/**\n *\n *\n * DOCS CARD\n *\n *\n */\n\nconst DocsCard = ({\n  func,\n  dispatch,\n  index,\n  functions,\n  navigationType,\n  ...rest\n}: {\n  func?: Ifunction\n  dispatch: React.Dispatch<Action>\n  index: number\n  functions: Ifunction[]\n  navigationType?: NavigationType\n} & ChakraProps) => {\n  const descriptionDecorator = new CompositeDecorator([\n    {\n      //TypeBadge\n      strategy(contentBlock, cb, contentState) {\n        findWithRegex(HANDLE_REGEX, contentBlock, cb)\n      },\n      component(props: any) {\n        return (\n          <Button\n            as='span'\n            variant='link'\n            color='unison.aqua'\n            fontSize='inherit'\n            fontStyle='inherit'\n            style={{\n              direction: 'ltr',\n              unicodeBidi: 'bidi-override',\n            }}\n            data-offset-key={props.offsetKey}\n            onClick={e => {\n              dispatch({\n                type: 'openDocs',\n                openerIndex: index,\n                fnName: props.decoratedText.slice(1),\n              })\n            }}\n          >\n            {props.children}\n          </Button>\n        )\n      },\n    },\n  ])\n  const originalState = React.useRef<{\n    name: string\n    signatureString: string\n    descriptionString: string\n    code: string\n  }>({\n    name: '',\n    signatureString: '',\n    descriptionString: '',\n    code: '',\n  })\n  const [state, setState] = React.useState<DocsCardState>(() => {\n    const state = getStateValueFromFunc(descriptionDecorator, func)\n    setOriginalState(originalState, state)\n    return state\n  })\n\n  const [previousFunc, setPreviousFunc] = React.useState(func)\n  if (previousFunc !== func) {\n    //reference check on function from state.functions\n    setPreviousFunc(func)\n    const state = getStateValueFromFunc(descriptionDecorator, func)\n    setOriginalState(originalState, state)\n    setState(state)\n  }\n  const { name, signature, description, code } = state\n\n  const closeButtonRef = React.useRef<HTMLButtonElement>(null)\n  React.useEffect(() => {\n    closeButtonRef.current?.scrollIntoView({ behavior: 'smooth' })\n  }, [])\n\n  /* Name */\n  const onChangeName = (name: string) => setState(state => ({ ...state, name }))\n  const nameFontStyle = [defaultName, ''].includes(name) ? 'italic' : 'normal'\n  const nameColor = [defaultName, ''].includes(name) ? 'gray.400' : 'normal'\n\n  /* Description */\n  const descriptionHasText = description.getCurrentContent().hasText()\n  const descriptionFontStyle = descriptionHasText ? 'normal' : 'italic'\n  const descriptionColor = descriptionHasText ? 'normal' : 'gray.400'\n  const onChangeDescription = (description: EditorState) => {\n    setState(state => ({ ...state, description }))\n    /* autocomplete description */\n    const trigger = '@'\n    window.requestAnimationFrame(() => {\n      const selection = window.getSelection() as Selection\n      if (selection.rangeCount === 0) {\n        //focus is outside\n        setAutocompleteDescription(null)\n        return\n      }\n      const stateSelection = description.getSelection()\n      const contentState = description.getCurrentContent()\n      const block = contentState.getBlockForKey(stateSelection.getStartKey())\n      if (\n        !stateSelection.getHasFocus() ||\n        block.getEntityAt(stateSelection.getStartOffset() - 1)\n      ) {\n        setAutocompleteDescription(null)\n        return\n      }\n      const range = selection.getRangeAt(0)\n      // let text = range.startContainer.textContent!.substring(\n      //   //b|oolean -> 'b\n      //   0,\n      //   range.startOffset,\n      // )\n      const wholeWordText = range.startContainer.textContent as string //b|oolean -> 'boolean'\n      let index = /*text*/ wholeWordText.lastIndexOf(trigger)\n      if (index === -1) {\n        setAutocompleteDescription(null)\n        return\n      }\n      /*previously reassigned text here*/ let text = wholeWordText.substring(\n        index,\n      )\n      text = text === trigger ? '' : text.slice(1)\n\n      // const autocompleteRange = {\n      //   text, start:index,end: range.startOffset\n      // }\n\n      const tempRange = window.getSelection()!.getRangeAt(0).cloneRange()\n      tempRange.setStart(tempRange.startContainer, index)\n      const rangeRect = tempRange.getBoundingClientRect()\n      let [left, top] = [rangeRect.left, rangeRect.bottom]\n      //\n\n      setAutocompleteDescription({\n        left,\n        top,\n        text,\n        // wholeWordText,\n        startIndex: index,\n        selectedIndex: 0,\n      })\n    })\n  }\n  // const descriptionEditorRef = React.useRef(null)\n  const [\n    autocompleteDescription,\n    setAutocompleteDescription,\n  ] = React.useState<any>(null)\n  const filteredFunctions = getFilteredFunctions(\n    functions,\n    autocompleteDescription?.text,\n  )\n  const descriptionEditorRef = React.useRef<DraftEditor>(null)\n  const handleDescriptionKeyCommand = (\n    command: 'up' | 'down' | 'close' | 'select' | string,\n    clickIndex?: number,\n  ) => {\n    if (filteredFunctions.length === 0) return 'not-handled'\n    switch (command) {\n      case 'up': {\n        setAutocompleteDescription((state: any) => ({\n          ...state,\n          selectedIndex:\n            state.selectedIndex === 0 ? 0 : state.selectedIndex - 1,\n        }))\n        return 'handled'\n      }\n      case 'down': {\n        setAutocompleteDescription((state: any) => ({\n          ...state,\n          selectedIndex:\n            state.selectedIndex === filteredSuggestions.length - 1\n              ? filteredSuggestions.length - 1\n              : state.selectedIndex + 1,\n        }))\n        return 'handled'\n      }\n      case 'close': {\n        descriptionEditorRef.current!.blur()\n        return 'handled'\n      }\n      case 'select': {\n        const trigger = '@'\n        const currentSelectionState = description.getSelection()\n        const anchorOffset /*end */ = currentSelectionState.getAnchorOffset()\n        const anchorKey = currentSelectionState.getAnchorKey()\n        const currentContent = description.getCurrentContent()\n        const currentBlock = currentContent.getBlockForKey(anchorKey)\n        const blockText = currentBlock.getText()\n\n        // const start = blockText.substring(0, end).lastIndexOf(trigger)\n        // return {\n        // editorState,\n        // start,\n        // end,\n        // trigger,\n        // selectedIndex: autocompleteSignature.selectedIndex,\n        // }\n\n        // add suggestion\n        const textToInsert =\n          trigger +\n          filteredFunctions[clickIndex ?? autocompleteDescription.selectedIndex]\n            .name\n        const newCurrentContent = currentContent.createEntity(\n          'FUNCTION',\n          'IMMUTABLE',\n        )\n        const entityKey = newCurrentContent.getLastCreatedEntityKey()\n        const mentionTextSelection = currentSelectionState.merge({\n          // anchorOffset: autocompleteDescription.startIndex,\n          anchorOffset: blockText.lastIndexOf(trigger),\n          focusOffset: anchorOffset,\n        })\n        let insertingContent = Modifier.replaceText(\n          description.getCurrentContent(),\n          mentionTextSelection,\n          textToInsert,\n          undefined,\n          // ['link', 'BOLD'],\n          entityKey,\n        )\n        const editorStateWithEntity = EditorState.push(\n          description,\n          insertingContent,\n          'apply-entity',\n        )\n        // const newEditorState = EditorState.push(\n        //   editorStateWithEntity,\n        //   ' ',\n        //   'insert-characters',\n        // )\n        setState(state => ({ ...state, description: editorStateWithEntity }))\n        setAutocompleteDescription(null)\n\n        // EditorState.forceSelection(\n        //   newEditorState,\n        //   insertingContent.getSelectionAfter(),\n        // ),\n\n        return 'handled'\n      }\n      default:\n        return 'not-handled'\n    }\n  }\n\n  /* Signature */\n\n  // const [signatureEditorState, setSignatureEditorState] = React.useState(() =>\n  //   EditorState.createEmpty(signatureDecorator),\n  // )\n  const signatureEditorRef = React.useRef<DraftEditor>(null)\n  const signatureEditorParentRef = React.useRef<HTMLElement>(null)\n  const coordsSignatureEditor = React.useRef<any>(null)\n\n  const onChangeSignatureEditor = (e: EditorState) => {\n    let newEditorState: EditorState\n    switch (e.getLastChangeType()) {\n      case 'insert-characters':\n        const text = e.getCurrentContent().getFirstBlock().getText()\n        let newText = text\n        const triggerArrow = text.endsWith(',') || text.endsWith(' ')\n        if (triggerArrow) {\n          //TODO arrow component\n          const previousMeaningfulCharIsArrow = text\n            .replace(',', ' ')\n            .trimEnd()\n            .endsWith(arrow)\n          const previousCharIsClosingBracket = text\n            .substr(0, text.length - 1)\n            .endsWith('}')\n          if (previousMeaningfulCharIsArrow) {\n            newText = text //.substr(0, text.length - 1)\n          } else if (previousCharIsClosingBracket && text.endsWith(' ')) {\n            //abilities\n            newText = text\n          } else {\n            // only if last non-space or comma char is not arrow\n            newText = text.substr(0, text.length - 1).concat(` ${arrow} `)\n          }\n        }\n\n        newEditorState =\n          text === newText\n            ? e\n            : EditorState.moveFocusToEnd(\n                EditorState.push(\n                  e,\n                  ContentState.createFromText(newText),\n                  'insert-fragment',\n                ),\n              )\n        break\n      default:\n        newEditorState = e\n        break\n    }\n    setState(state => ({ ...state, signature: newEditorState }))\n\n    /* autocomplete signature */\n\n    window.requestAnimationFrame(() => {\n      const selection = window.getSelection() as Selection\n      if (selection.rangeCount === 0) {\n        //focus is outside\n        setAutocompleteSignature(null)\n        return\n      }\n      const stateSelection = newEditorState.getSelection()\n      // const contentState = newEditorState.getCurrentContent()\n      // const block = contentState.getBlockForKey(stateSelection.getStartKey())\n      if (\n        !stateSelection.getHasFocus() /*||\n        block.getEntityAt(stateSelection.getStartOffset() - 1*/\n      ) {\n        setAutocompleteSignature(null)\n        return\n      }\n      const range = selection.getRangeAt(0)\n      // let text = range.startContainer.textContent//!.substring(\n      //b|oolean -> 'b\n      //0,\n      //range.startOffset,\n      //)\n\n      const wholeWordText = range.startContainer.textContent as string //b|oolean -> 'boolean'\n      let index = wholeWordText.length > 0 ? wholeWordText.lastIndexOf(' ') : 0\n      index = index === -1 ? 0 : index\n      const text = wholeWordText.substring(index).trim()\n\n      let { left } = range.getBoundingClientRect()\n      const editorParent = signatureEditorParentRef.current as HTMLElement\n      const coords =\n        coordsSignatureEditor.current ?? editorParent.getBoundingClientRect()\n      coordsSignatureEditor.current = coords //TODO reset this cache\n      let top = coords.bottom\n      if (left === 0) {\n        left = coords.left\n      }\n\n      setAutocompleteSignature({\n        left,\n        top,\n        text,\n        wholeWordText,\n        startIndex: index,\n        selectedIndex: 0,\n      })\n    })\n  }\n  const handleKeyCommand = (\n    command: 'up' | 'down' | 'close' | 'select' | string,\n    clickIndex?: number,\n  ) => {\n    if (filteredSuggestions.length === 0) return 'not-handled'\n    switch (command) {\n      case 'up': {\n        setAutocompleteSignature((state: any) => ({\n          ...state,\n          selectedIndex:\n            state.selectedIndex === 0 ? 0 : state.selectedIndex - 1,\n        }))\n        return 'handled'\n      }\n      case 'down': {\n        setAutocompleteSignature((state: any) => ({\n          ...state,\n          selectedIndex:\n            state.selectedIndex === filteredSuggestions.length - 1\n              ? filteredSuggestions.length - 1\n              : state.selectedIndex + 1,\n        }))\n        return 'handled'\n      }\n      case 'close': {\n        signatureEditorRef.current!.blur()\n        return 'handled'\n      }\n      case 'select': {\n        const currentSelectionState = signature.getSelection()\n        const anchorOffset /*end */ = currentSelectionState.getAnchorOffset()\n        const anchorKey = currentSelectionState.getAnchorKey()\n        const currentContent = signature.getCurrentContent()\n        const currentBlock = currentContent.getBlockForKey(anchorKey)\n        const blockText = currentBlock.getText()\n        // const start = blockText.substring(0, end).lastIndexOf(trigger)\n        // return {\n        // editorState,\n        // start,\n        // end,\n        // trigger,\n        // selectedIndex: autocompleteSignature.selectedIndex,\n        // }\n\n        // add suggestion\n        const newCurrentContent = currentContent.createEntity(\n          'TYPE',\n          'IMMUTABLE',\n        )\n        const entityKey = newCurrentContent.getLastCreatedEntityKey()\n\n        //\n        let index = blockText.length > 0 ? blockText.lastIndexOf(' ') : 0\n        index = index === -1 ? 0 : index\n\n        const fnName =\n          filteredSuggestions[clickIndex ?? autocompleteSignature.selectedIndex]\n            .title\n        const textToInsert = index === 0 ? fnName : ' ' + fnName\n        const mentionTextSelection = currentSelectionState.merge({\n          // anchorOffset: autocompleteSignature.startIndex,\n          anchorOffset: index,\n          focusOffset: anchorOffset,\n        })\n        let insertingContent = Modifier.replaceText(\n          signature.getCurrentContent(),\n          mentionTextSelection,\n          textToInsert,\n          undefined,\n          // ['link', 'BOLD'],\n          entityKey,\n        )\n        const newEditorState = EditorState.push(\n          signature,\n          insertingContent,\n          'apply-entity',\n        )\n        setState(state => ({ ...state, signature: newEditorState }))\n        setAutocompleteSignature(null)\n        // EditorState.forceSelection(\n        //   newEditorState,\n        //   insertingContent.getSelectionAfter(),\n        // ),\n\n        return 'handled'\n      }\n      default:\n        return 'not-handled'\n    }\n  }\n\n  const [autocompleteSignature, setAutocompleteSignature] = React.useState<any>(\n    null,\n  )\n  const filteredSuggestions = getFilteredTypeSuggestions(\n    typeSuggestions,\n    autocompleteSignature?.text,\n  )\n\n  /* Code */\n\n  const onChangeCode = (code: string) => setState(state => ({ ...state, code }))\n  const signatureString = signature.getCurrentContent().getPlainText()\n  const paramsAndReturns = getParamsAndReturns(signatureString)\n  const params = paramsAndReturns.slice(0, paramsAndReturns.length - 1)\n  const paramNames = getParamNames(params)\n  const editorValue =\n    code || `function ${name || 'name'}(${paramNames.join(', ')}) {\\n\\n}`\n\n  // const [signatureTouched, setSignatureTouched] = React.useState<boolean>(false)\n  const signatureError = !isSignatureCorrect(paramsAndReturns)\n\n  const hasChanges =\n    name !== originalState.current.name ||\n    signatureString !== originalState.current.signatureString ||\n    description.getCurrentContent().getPlainText() !==\n      originalState.current.descriptionString ||\n    code !== originalState.current.code\n\n  const onSaveButtonClick = () => {\n    const fn = safeEval(code)\n    const validParams = isSignatureCorrect(paramsAndReturns)\n    if (!fn || !validParams) {\n      return //TODO alert\n    }\n    const parameters = paramsAndReturns.slice(\n      0,\n      paramsAndReturns.length - 1,\n    ) as Itype[] //TODO cast\n    const returns = paramsAndReturns.slice(-1).pop() as Itype\n    dispatch({\n      type: 'createFunction',\n      function: {\n        name,\n        parameters,\n        returns,\n        fn,\n        description: description.getCurrentContent().getPlainText(),\n      },\n      index,\n    })\n  }\n\n  const onClearButtonClick = useCallback(() => {\n    const state = getStateValueFromFunc(descriptionDecorator, undefined)\n    setOriginalState(originalState, state)\n    setState(state)\n    dispatch({ type: 'clearDocsCard', index })\n  }, [originalState, index])\n\n  return (\n    <Box\n      // boxShadow={'base'}\n      backgroundColor='white'\n      padding={1}\n      // minWidth='48%'\n      // minHeight='99vh'\n      minHeight='100%'\n      // position='relative'\n      display='flex'\n      flexDirection='column'\n      {...rest}\n    >\n      <Flex paddingLeft={2} alignItems='center'>\n        <Heading fontSize='xl' fontStyle='italic' color='unison.purple'>\n          Docs\n        </Heading>\n        {navigationType === 'history' ? (\n          <DocsNavigationArrows></DocsNavigationArrows>\n        ) : null}\n        <Spacer></Spacer>\n        <ClearButton\n          onClick={onClearButtonClick}\n          fadeIn={hasChanges}\n        ></ClearButton>\n        <SaveButton\n          onClick={onSaveButtonClick}\n          fadeIn={hasChanges}\n          disabled={signatureError}\n        ></SaveButton>\n        <DocsExplanation />\n        {navigationType ? (\n          <DocsNavigationTypeSelector\n            dispatch={dispatch}\n            navigationType={navigationType}\n          ></DocsNavigationTypeSelector>\n        ) : null}\n        <IconButton\n          /* Close Button */\n          aria-label='Close card'\n          icon={<CloseIcon />}\n          variant='ghost'\n          size='sm'\n          onClick={() => dispatch({ type: 'closeDocsCard', index })}\n          /* Scrolling behavior */\n          ref={closeButtonRef}\n          sx={{\n            scrollMarginRight: '20px',\n          }}\n        />\n      </Flex>\n      <Divider marginTop={2}></Divider>\n      <Droppable droppableId='DocsCard'>\n        {(provided, snapshot) => {\n          return (\n            <Box\n              ref={provided.innerRef}\n              {...provided.droppableProps}\n              // minWidth={'50%'}\n              flex={1}\n              minHeight='100%'\n              height='100%'\n              overflow='auto'\n              paddingX={2}\n              paddingY={2}\n            >\n              <EditableText\n                /* NAME */\n                value={name}\n                onChange={onChangeName}\n                placeholder={defaultName}\n                fontSize='2xl'\n                textColor={nameColor}\n                fontStyle={nameFontStyle}\n                marginBottom={3}\n              />\n\n              {/* SIGNATURE */}\n              <HStack>\n                <Code fontSize='sm' padding={0.5}>\n                  <Editable\n                    as='span'\n                    placeholder={defaultName}\n                    fontStyle={nameFontStyle}\n                    // width={name.length * 12 + 12 + 'px'}\n                    width={(name.length > 3 ? name.length : 4) * 9 + 9 + 'px'}\n                    // minWidth={(name || defaultName).length * 12 + 12 + 'px'}\n                    value={name}\n                    textColor={nameColor}\n                    onChange={onChangeName}\n                    paddingX={1}\n                  >\n                    <EditablePreview\n                      width={(name.length > 3 ? name.length : 4) * 9 + 9 + 'px'}\n                    />\n                    <EditableInput\n                      width={(name.length > 3 ? name.length : 4) * 9 + 9 + 'px'}\n                      _focus={{\n                        outline: '',\n                      }}\n                    />\n                  </Editable>\n                </Code>\n\n                <Text as='span' fontSize='sm'>\n                  :{' '}\n                </Text>\n                <Code\n                  // SIGNATURE EDITOR\n                  fontSize='sm'\n                  width='100%'\n                  paddingX={1}\n                  paddingY={1}\n                  as='span'\n                  ref={signatureEditorParentRef}\n                  // position='relative'\n                >\n                  <DraftEditor\n                    editorState={signature}\n                    ref={signatureEditorRef}\n                    onChange={onChangeSignatureEditor}\n                    keyBindingFn={autocompleteKeyBindingFn}\n                    handleKeyCommand={e => handleKeyCommand(e)}\n\n                    // onBlur={(e: any) => {\n                    //   setSignatureTouched(true)\n                    // }}\n                  />\n                  {filteredSuggestions.length > 0 ? (\n                    <TypeSuggestionList\n                      typeSuggestions={filteredSuggestions}\n                      selectedIndex={autocompleteSignature.selectedIndex}\n                      left={autocompleteSignature.left}\n                      top={autocompleteSignature.top}\n                    ></TypeSuggestionList>\n                  ) : null}\n                </Code>\n              </HStack>\n\n              <Text\n                /* DESCRIPTION */\n                className='description'\n                marginTop={5}\n                fontSize='xl'\n                fontStyle={descriptionFontStyle}\n                color={descriptionColor}\n                backgroundColor='yellow.50'\n                padding={3}\n              >\n                <DraftEditor\n                  ref={descriptionEditorRef}\n                  placeholder='Description'\n                  editorState={description}\n                  onChange={onChangeDescription}\n                  keyBindingFn={autocompleteKeyBindingFn}\n                  handleKeyCommand={e => handleDescriptionKeyCommand(e)}\n                ></DraftEditor>\n                {filteredFunctions.length > 0 ? (\n                  <FunctionSuggestionList\n                    onClick={(clickIndex: number) =>\n                      handleDescriptionKeyCommand('select', clickIndex)\n                    }\n                    functionSuggestions={filteredFunctions}\n                    selectedIndex={autocompleteDescription.selectedIndex}\n                    left={autocompleteDescription.left}\n                    top={autocompleteDescription.top}\n                  ></FunctionSuggestionList>\n                ) : null}\n              </Text>\n              {/* <Tabs marginTop={5}>\n                <TabList>\n                  <Tab>Regular editor</Tab>\n                  <Tab>Structured editor</Tab>\n                </TabList>\n                <TabPanels>\n                  <TabPanel> */}\n              <Box marginTop={5}>\n                <MonacoEditor\n                  value={editorValue}\n                  onChange={(_: any, v: any) => {\n                    onChangeCode(v)\n                  }}\n                ></MonacoEditor>\n              </Box>\n\n              {/* </TabPanel>\n                  <TabPanel>\n                    <Code>{editorValue}</Code>\n                  </TabPanel>\n                </TabPanels>\n              </Tabs> */}\n\n              {provided.placeholder}\n            </Box>\n          )\n        }}\n      </Droppable>\n    </Box>\n  )\n}\nexport default DocsCard\n","import * as React from 'react'\nimport {\n  ControlledEditor,\n  ControlledEditorOnChange,\n} from '@monaco-editor/react'\nfunction Editor({\n  value,\n  onChange,\n}: {\n  value: string\n  onChange: ControlledEditorOnChange\n}) {\n  // function onChange(newValue: any, e: any) {\n  //   console.log('onChange', newValue, e)\n  // }\n\n  // const code = this.state.code;\n  const options: { lineNumbers: 'off'; minimap: { enabled: boolean } } = {\n    // selectOnLineNumbers: true,\n    minimap: { enabled: false },\n    lineNumbers: 'off',\n  }\n  return (\n    <ControlledEditor\n      width='100%'\n      height='30vh'\n      language='javascript'\n      theme='vs-light'\n      value={value}\n      options={options}\n      onChange={onChange}\n      // editorDidMount={(editor, monaco) =>\n      //   console.log('editorDidMount', { editor, monaco })\n      // }\n    />\n  )\n}\nexport default Editor\n","import * as React from 'react'\nimport {\n  EditableProps,\n  Editable,\n  EditablePreview,\n  EditableInput,\n  forwardRef,\n} from '@chakra-ui/react'\n\nconst EditableText = forwardRef((props: EditableProps, ref) => (\n  <Editable {...props}>\n    <EditablePreview />\n    <EditableInput\n      ref={ref}\n      _focus={{\n        outline: '',\n      }}\n    />\n  </Editable>\n))\n\nexport default EditableText\n","import * as React from 'react'\nimport { Droppable, Draggable } from 'react-beautiful-dnd'\nimport type { Ieffect, Itype, Ifunction } from './interfaces'\nimport {\n  Box,\n  Code,\n  forwardRef,\n  Input,\n  InputGroup,\n  InputLeftElement,\n  Text,\n  Kbd,\n  ListItem,\n  UnorderedList,\n  Center,\n  useTheme,\n  InputRightElement,\n  InputRightAddon,\n  HStack,\n} from '@chakra-ui/react'\nimport { makeStyles } from '@material-ui/core/styles'\nimport TreeView from '@material-ui/lab/TreeView'\nimport TreeItem from '@material-ui/lab/TreeItem'\nimport {\n  ChevronDownIcon,\n  ChevronRightIcon,\n  ArrowForwardIcon,\n  SearchIcon,\n} from '@chakra-ui/icons'\nimport { FaShapes } from 'react-icons/fa'\n// import { VscSymbolMisc as FaShapes } from 'react-icons/vsc'\nimport { GiMineExplosion } from 'react-icons/gi'\n// import { IoShapes } from 'react-icons/io' //RiFunctionLine, RiFunctionFill //IoShapesOutline\nimport './sideBarStyles.css'\nimport TypeBadge from './TypeBadge'\nimport { Action } from '../state'\nimport MouseTrap from 'mousetrap'\n// import { FlowFunctionView } from './FlowCard'\nimport PopoverExplanation from './PopoverExplanation'\n\ntype IsideBarItem =\n  | {\n      nodeId: 'functions'\n      label: 'Functions'\n      items: Array<Ifunction>\n    }\n  | {\n      nodeId: 'types'\n      label: 'Data Types'\n      items: Array<Itype>\n    }\n  | {\n      nodeId: 'effects'\n      label: 'Effects'\n      items: Array<Ieffect>\n    }\n\nexport const FunctionItem = (props: Ifunction) => {\n  return (\n    <Text\n      wrap='nowrap'\n      color='unison.purple'\n      _hover={{ color: 'unison.lightPurple' }}\n    >\n      <Code\n        fontSize='sm'\n        // fontWeight='700'\n        paddingX={1}\n        paddingY={0.5}\n        rounded='base'\n        backgroundColor='transparent'\n        color='inherit'\n      >\n        {props.name}\n      </Code>\n      <Text as='span'>: </Text>\n      <Text as={'span'} flexWrap='nowrap'>\n        {props.parameters.map((p, i) => (\n          <Text as='span' key={i}>\n            <TypeBadge typeAsString={p.type} />\n            <ArrowForwardIcon marginX={1} />\n          </Text>\n        ))}\n      </Text>\n      <TypeBadge typeAsString={props.returns.type} />\n    </Text>\n  )\n}\n\nconst getFunctionRenderItem = (props: Ifunction) => (\n  provided: any,\n  snapshot: any,\n  rubric: any,\n) => {\n  return (\n    <div\n      {...provided.draggableProps}\n      {...provided.dragHandleProps}\n      ref={provided.innerRef}\n      style={provided.draggableProps.style}\n    >\n      <div>\n        <FunctionItem {...props} />\n        {/* <FlowFunctionView item={{ ...props }} /> */}\n      </div>\n    </div>\n  )\n}\nconst useTreeItemStyles = makeStyles({\n  root: {\n    marginBottom: '5px',\n  },\n  content: {\n    '&:hover': {\n      backgroundColor: 'transparent',\n      cursor: 'grabbing',\n    },\n  },\n})\n\nconst FunctionTreeItem = (\n  props: Ifunction & { nodeId: string; isAnyItemDragging: boolean },\n) => {\n  const { root, content } = useTreeItemStyles()\n  return (\n    <TreeItem\n      classes={{ root, content: props.isAnyItemDragging ? content : undefined }}\n      nodeId={props.nodeId}\n      label={\n        <Droppable\n          droppableId={props.nodeId}\n          renderClone={getFunctionRenderItem(props)}\n          isDropDisabled={true}\n        >\n          {(provided, snapshot) => {\n            const shouldRenderClone =\n              props.nodeId === snapshot.draggingFromThisWith\n            return (\n              <div ref={provided.innerRef} {...provided.droppableProps}>\n                {shouldRenderClone ? (\n                  <div className='react-beautiful-dnd-copy'>\n                    <FunctionItem {...props}></FunctionItem>\n                  </div>\n                ) : (\n                  <Draggable draggableId={props.nodeId} index={0}>\n                    {(provided, snapshot) => {\n                      return (\n                        <div\n                          ref={provided.innerRef}\n                          {...provided.draggableProps}\n                          {...provided.dragHandleProps}\n                        >\n                          <FunctionItem {...props}></FunctionItem>\n                        </div>\n                      )\n                    }}\n                  </Draggable>\n                )}\n                {/* {provided.placeholder} */}\n              </div>\n            )\n          }}\n        </Droppable>\n      }\n    ></TreeItem>\n  )\n}\nconst TypeTreeItem = (\n  props: Itype & { nodeId: string; isAnyItemDragging: boolean },\n) => {\n  const { content } = useTreeItemStyles()\n  return (\n    <TreeItem\n      nodeId={props.nodeId}\n      classes={{ content: props.isAnyItemDragging ? content : undefined }}\n      label={<TypeBadge typeAsString={props.type}></TypeBadge>}\n    />\n  )\n}\n\nconst Sidebar = React.memo(\n  forwardRef(\n    (\n      {\n        items,\n        isAnyItemDragging,\n        dispatch,\n        searchValue,\n      }: {\n        items: Array<IsideBarItem>\n        isAnyItemDragging: boolean\n        dispatch: React.Dispatch<Action>\n        searchValue: string\n      },\n      ref,\n    ) => {\n      const theme = useTheme()\n      const {\n        colors: {\n          unison: { purple, lightPurple, aqua },\n        },\n      } = theme\n\n      //Search\n      const [isHoveringSearch, setIsHoveringSearch] = React.useState(false)\n      const [isFocusedSearch, setFocusedSearch] = React.useState(false)\n      const onMouseEnterSearch = React.useCallback(() => {\n        setIsHoveringSearch(true)\n      }, [])\n      const onMouseLeaveSearch = React.useCallback(() => {\n        setIsHoveringSearch(false)\n      }, [])\n\n      return (\n        <Box\n          height='100%'\n          flex={1}\n          backgroundColor={'purple.50'}\n          paddingTop={4}\n        >\n          <InputGroup\n            width='100%'\n            whiteSpace='nowrap'\n            padding={1}\n            display='flex'\n            onMouseEnter={onMouseEnterSearch}\n            onMouseLeave={onMouseLeaveSearch}\n            // _focusWithin={{ color: 'teal.600' }}\n          >\n            <InputLeftElement\n              pointerEvents='none'\n              children={\n                <SearchIcon\n                  color={\n                    isFocusedSearch\n                      ? aqua\n                      : isHoveringSearch\n                      ? lightPurple\n                      : purple\n                  }\n                />\n              } //TODO teal\n            />\n            <Input\n              ref={ref}\n              placeholder='Search'\n              variant='outline'\n              _hover={{ borderBottomColor: lightPurple }}\n              focusBorderColor={'unison.aqua'}\n              size='md'\n              borderRadius='0%'\n              borderTop='none'\n              borderLeft='none'\n              borderRight='none'\n              borderBottom={`2px solid ${purple}`}\n              value={searchValue}\n              onFocus={() => {\n                if (!ref || !('current' in ref)) return\n                ref.current.setSelectionRange(0, ref.current.value.length)\n                setFocusedSearch(true)\n              }}\n              onBlur={() => setFocusedSearch(false)}\n              onChange={e =>\n                dispatch({ type: 'sideBarSearch', value: e.target.value })\n              }\n            />\n            {isHoveringSearch ? (\n              <HStack\n                background='transparent'\n                position='absolute'\n                right={2}\n                top={2}\n                pointerEvents='none'\n              >\n                <Kbd>ctrl</Kbd>\n                <Text>/</Text>\n                <Kbd>⌘</Kbd>\n                <Text>+</Text>\n                <Kbd>B</Kbd>\n              </HStack>\n            ) : null}\n          </InputGroup>\n          <Center>\n            <PopoverExplanation label='Sidebar explanation' title='Sidebar'>\n              <UnorderedList>\n                <ListItem>\n                  Drag functions and drop them onto Flow Card or Docs Card\n                </ListItem>\n                <ListItem>\n                  <Kbd>up</Kbd>, <Kbd>down</Kbd>, <Kbd>left</Kbd>,{' '}\n                  <Kbd>right</Kbd> to move in Sidebar\n                </ListItem>\n                <ListItem>\n                  <Kbd>space</Kbd> to drag, <Kbd>right</Kbd> then{' '}\n                  <Kbd>space</Kbd> to drop\n                </ListItem>\n                <ListItem>\n                  Datatypes and Effects are not interactive at this point\n                </ListItem>\n              </UnorderedList>\n            </PopoverExplanation>\n          </Center>\n\n          <TreeView\n            selected={[]}\n            aria-label='Functions, types and effects'\n            defaultCollapseIcon={<ChevronDownIcon color='unison.purple' />}\n            defaultExpandIcon={<ChevronRightIcon color='unison.purple' />}\n            onNodeFocus={(e, v) => {\n              const draggable: any = document.querySelector(\n                `[data-rbd-draggable-id=\"${v}\"]`,\n              )\n\n              if (draggable) {\n                const focused = document.querySelectorAll('.Mui-focused')\n                focused.forEach(e => {\n                  e.classList.remove('Mui-focused')\n                })\n                const div =\n                  draggable.parentElement?.parentElement?.parentElement\n                const li = div?.parentElement\n                const parentMenu =\n                  li?.parentElement?.parentElement?.parentElement?.parentElement\n                const previous = li?.previousElementSibling\n                const next = li?.nextElementSibling\n\n                if (!draggable.bound) {\n                  draggable.bound = true\n                  MouseTrap(draggable).bind('left', e => {\n                    if (isAnyItemDragging) {\n                      return\n                    }\n                    div?.classList.remove('Mui-focused')\n                    parentMenu?.focus()\n                  })\n                  MouseTrap(draggable).bind('down', e => {\n                    if (isAnyItemDragging) {\n                      return\n                    }\n                    if (next) {\n                      next.focus()\n                      div?.classList.remove('Mui-focused')\n                    } else {\n                      parentMenu?.nextElementSibling?.focus()\n                      div?.classList.remove('Mui-focused')\n                    }\n                  })\n                  MouseTrap(draggable).bind('up', e => {\n                    if (isAnyItemDragging) {\n                      return\n                    }\n                    if (previous) {\n                      previous.focus()\n                      div?.classList.remove('Mui-focused')\n                    } else {\n                      parentMenu?.focus()\n                      div?.classList.remove('Mui-focused')\n                    }\n                  })\n                }\n\n                div?.classList.add('Mui-focused')\n                draggable.focus()\n              }\n            }}\n          >\n            {items &&\n              items.map(item => {\n                const label = (\n                  <Text fontSize='lg' color={'unison.purple'}>\n                    {item.label}\n                  </Text>\n                )\n                return (\n                  <TreeItem\n                    nodeId={item.nodeId}\n                    key={item.nodeId}\n                    label={\n                      <HStack>\n                        {item.nodeId === 'functions' ? (\n                          <Text fontWeight='bold' fontSize='xl' color={purple}>\n                            λ\n                          </Text>\n                        ) : item.nodeId === 'types' ? (\n                          <FaShapes color={purple} />\n                        ) : item.nodeId === 'effects' ? (\n                          <GiMineExplosion color={purple} />\n                        ) : null}\n                        {label}\n                      </HStack>\n                    }\n                  >\n                    {(() => {\n                      switch (item.nodeId) {\n                        case 'functions':\n                          return item.items.map(innerItem => {\n                            const id = `${item.nodeId}_${innerItem.name}`\n                            return (\n                              <FunctionTreeItem\n                                {...innerItem}\n                                key={id}\n                                nodeId={id}\n                                isAnyItemDragging={!!isAnyItemDragging}\n                              />\n                            )\n                          })\n                        case 'types':\n                          return item.items.map(innerItem => {\n                            const id = `${item.nodeId}_${innerItem.type}`\n                            return (\n                              <TypeTreeItem\n                                {...innerItem}\n                                key={id}\n                                nodeId={id}\n                                isAnyItemDragging={!!isAnyItemDragging}\n                              />\n                            )\n                          })\n                        case 'effects':\n                          return null //@TODO\n                        default:\n                          let _: never = item\n                      }\n                    })()}\n                  </TreeItem>\n                )\n              })}\n          </TreeView>\n        </Box>\n      )\n    },\n  ),\n)\n\nexport default Sidebar\n","import * as React from 'react'\nimport { Droppable, Draggable } from 'react-beautiful-dnd'\nimport { Ifunction, Itype } from './interfaces'\nimport {\n  Box,\n  Flex,\n  Spacer,\n  Code,\n  HStack,\n  VStack,\n  forwardRef,\n  Divider,\n  Button,\n  Input,\n  NumberInput,\n  NumberInputField,\n  Text,\n  Heading,\n  Grid,\n  GridItem,\n  Fade,\n  ChakraProps,\n  UnorderedList,\n  ListItem,\n  Switch,\n} from '@chakra-ui/react'\nimport { ArrowDownIcon, ArrowForwardIcon, DeleteIcon } from '@chakra-ui/icons'\nimport TypeBadge from './TypeBadge'\nimport { Action } from '../state'\nimport PopoverExplanation from './PopoverExplanation'\nimport './flowCardStyles.css'\n\nconst TypeAndValue = React.memo(\n  ({\n    type,\n    value,\n    onChange,\n    direction,\n  }: {\n    type: Itype['type']\n    value: any\n    onChange?: (v: string | number | boolean) => void\n    direction: 'row' | 'column'\n  }) => {\n    return (\n      <Flex direction={direction} justifyContent='center' alignItems='center'>\n        <TypeBadge typeAsString={type} />\n        {(() => {\n          if (!onChange) {\n            return (\n              <Code>\n                {type === 'boolean' ? (value ? 'true' : 'false') : value}\n              </Code>\n            )\n          }\n          switch (type) {\n            case 'string':\n              return (\n                <Input\n                  size='sm'\n                  value={value}\n                  variant='outline'\n                  backgroundColor='white'\n                  focusBorderColor={'unison.aqua'}\n                  rounded='base'\n                  onChange={e => {\n                    onChange(e.target.value)\n                  }}\n                ></Input>\n              )\n            case 'number':\n              return (\n                <NumberInput\n                  size='sm'\n                  value={value}\n                  variant='outline'\n                  backgroundColor='white'\n                  focusBorderColor={'unison.aqua'}\n                  rounded='base'\n                  onChange={(s, n) => {\n                    if (isNaN(Number(n))) {\n                      return\n                    }\n                    onChange(n)\n                  }}\n                  allowMouseWheel\n                >\n                  <NumberInputField />\n                  {/* <NumberInputStepper> */}\n                  {/* <NumberIncrementStepper /> */}\n                  {/* <NumberDecrementStepper /> */}\n                  {/* </NumberInputStepper> */}\n                </NumberInput>\n              )\n            case 'boolean':\n              return (\n                <>\n                  <Switch\n                    colorScheme={'purple'}\n                    isChecked={value}\n                    onChange={e => {\n                      onChange(e.target.checked)\n                    }}\n                  ></Switch>\n                  <Text>{value ? 'true' : 'false'}</Text>\n                </>\n              )\n            default:\n              return null\n          }\n        })()}\n      </Flex>\n    )\n  },\n)\n\nconst getParamValues = (\n  items: IfunctionWithId[],\n  v: string | number | boolean,\n  paramIndex: number | 'last',\n) => {\n  let previousReturn = null\n  let newItems: IfunctionWithId[] = []\n\n  for (let i = 0; i < items.length; i++) {\n    const item = items[i]\n    const parameters = [...item.parameters]\n    if (i === 0) {\n      //donde se ha producido el cambio\n      const param =\n        paramIndex === 'last'\n          ? parameters[parameters.length - 1]\n          : parameters[paramIndex]\n      param.value = v\n    }\n    const previouslastParam: Itype | undefined =\n      parameters[parameters.length - 1]\n\n    if (previouslastParam) {\n      parameters[parameters.length - 1] = {\n        ...previouslastParam,\n        value:\n          previousReturn === null ? previouslastParam?.value : previousReturn,\n      }\n    }\n\n    //TODO typecheck\n\n    let returnValue\n    try {\n      returnValue = item.fn(...parameters.map(p => p.value))\n    } catch (error) {\n      console.log({ error })\n      break\n    }\n\n    newItems.push({\n      ...item,\n      parameters,\n      returns: { ...item.returns, value: returnValue },\n    })\n\n    previousReturn = returnValue\n  }\n\n  return newItems\n}\n\nfunction sliceInTwo<A>(i: number, as: A[]) {\n  return [as.slice(0, i), as.slice(i)]\n}\n\nconst C_TypeAndValue = React.memo(\n  ({\n    fnId,\n    direction,\n    paramIndex,\n    noInput = false,\n  }: {\n    fnId: string\n    direction: 'row' | 'column'\n    paramIndex: number | 'last' | 'return'\n    noInput?: boolean\n  }) => {\n    const { fns, setFns } = React.useContext(ParameterContext)\n    const { parameters, returns, id } = fns.find(({ id }) => id === fnId)!\n    const param =\n      paramIndex === 'return'\n        ? returns\n        : paramIndex === 'last'\n        ? parameters[parameters.length - 1]\n        : parameters[paramIndex]\n\n    const onChange =\n      noInput || paramIndex === 'return'\n        ? undefined\n        : (v: string | number | boolean) => {\n            const [previousFns, affectedFns] = sliceInTwo(\n              fns.findIndex(({ id }) => id === fnId),\n              fns,\n            )\n            const newValues = getParamValues(affectedFns, v, paramIndex)\n            setFns(previousFns.concat(newValues))\n          }\n\n    return (\n      <TypeAndValue\n        type={param.type}\n        value={param.value}\n        onChange={onChange}\n        direction={direction}\n      />\n    )\n  },\n)\n\nexport const FlowFunctionView = React.memo(\n  forwardRef(\n    (\n      {\n        item,\n        // style,\n        // onChangeParam,\n        isFirstFunctionInFlow,\n        ...rest\n      }: {\n        item: Ifunction & { id: string }\n        // style?: React.CSSProperties\n        isFirstFunctionInFlow: boolean\n        // onChangeParam: (_: {\n        //   paramValue: string | number | boolean\n        //   paramIndex: number\n        // }) => void\n      },\n      ref,\n    ) => {\n      const hasZeroParams = item.parameters.length === 0\n      const hasOneParam = item.parameters.length === 1\n      return (\n        <Grid\n          {...rest}\n          ref={ref}\n          backgroundColor='gray.200' //TODO\n          rounded='md'\n          marginBottom={1}\n          padding={1}\n          templateColumns='auto 25%'\n          width='100%'\n          gap={1}\n        >\n          <GridItem\n            width='100%'\n            display='flex'\n            flexDirection='row'\n            alignItems='center'\n          >\n            <Code justifySelf='flex-start' backgroundColor='transparent'>\n              {item.name}\n            </Code>\n\n            {hasZeroParams || hasOneParam\n              ? null\n              : item.parameters\n                  .slice(0, item.parameters.length - 1)\n                  .map((param, i) => {\n                    const css =\n                      i === item.parameters.length - 2\n                        ? { transform: 'rotate(-45deg)' }\n                        : null\n                    return (\n                      <HStack\n                        justifySelf='flex-end'\n                        width='100%'\n                        display='flex'\n                        alignItems='center'\n                        justifyContent='flex-end'\n                        key={i}\n                      >\n                        <C_TypeAndValue\n                          fnId={item.id}\n                          paramIndex={i}\n                          direction='column'\n                        />{' '}\n                        <ArrowForwardIcon css={css} />\n                      </HStack>\n                    )\n                  })}\n          </GridItem>\n          <GridItem width='100%'>\n            <VStack>\n              {hasZeroParams ? (\n                <Code>()</Code>\n              ) : (\n                <C_TypeAndValue\n                  fnId={item.id}\n                  paramIndex='last'\n                  direction='column'\n                  noInput={!isFirstFunctionInFlow}\n                />\n              )}\n              <ArrowDownIcon></ArrowDownIcon>\n              <C_TypeAndValue\n                fnId={item.id}\n                noInput\n                paramIndex='return'\n                direction='column'\n              />\n            </VStack>\n          </GridItem>\n        </Grid>\n      )\n    },\n  ),\n)\n\nconst getFnsValuesFromItems = (\n  items: Array<IfunctionWithId>,\n  previousItems: Array<IfunctionWithId> = [],\n) => {\n  let previousReturn = null\n  let newItems: IfunctionWithId[] = []\n\n  for (let i = 0; i < items.length; i++) {\n    const item = previousItems.find(pi => pi.id === items[i].id) ?? items[i]\n    const parameters = [...item.parameters]\n    const previouslastParam: Itype | undefined =\n      parameters[parameters.length - 1]\n    if (previouslastParam) {\n      parameters[parameters.length - 1] = {\n        ...previouslastParam,\n        value:\n          previousReturn === null ? previouslastParam?.value : previousReturn,\n      }\n    }\n\n    //TODO typecheck, show error\n    let returnValue\n    let error\n    try {\n      returnValue = item.fn(...parameters.map(p => p.value))\n    } catch (err) {\n      error = err\n      console.log({ error })\n    }\n\n    //TODO only push if no error\n    newItems.push({\n      ...item,\n      parameters,\n      returns: { ...item.returns, value: returnValue },\n    })\n\n    previousReturn = returnValue\n  }\n\n  return newItems\n}\n\nconst ParameterContext = React.createContext<{\n  fns: Array<IfunctionWithId>\n  setFns: React.Dispatch<React.SetStateAction<IfunctionWithId[]>>\n}>({ fns: [], setFns() {} })\n\ntype IfunctionWithId = Ifunction & { id: string }\n\nconst FlowFunctionsList = React.memo(\n  ({ items }: { items: Array<IfunctionWithId> }) => {\n    const [fns, setFns] = React.useState(getFnsValuesFromItems(items))\n    const [previousItems, setPreviousItems] = React.useState(items)\n    if (previousItems !== items) {\n      setPreviousItems(items)\n      setFns(previousValues => getFnsValuesFromItems(items, previousValues))\n    }\n\n    //Recoil?\n    //items deberia venir sin parameter values - se calculan en el setState o en el render? en el setState\n    // que pasa cuando viene una fn nueva?\n    // can FlowFunctionView never reupdate after initial render? not rerender if isFiFIFlow changes\n\n    return (\n      <ParameterContext.Provider value={{ fns, setFns }}>\n        {items.map((item, i) => {\n          return (\n            <Draggable key={item.id} draggableId={item.id} index={i}>\n              {(provided, snapshot) => {\n                return (\n                  <Fade in={true}>\n                    <FlowFunctionView\n                      isFirstFunctionInFlow={i === 0}\n                      item={item}\n                      ref={provided.innerRef}\n                      {...provided.draggableProps}\n                      {...provided.dragHandleProps}\n                      // style={provided.draggableProps.style}\n                    />\n                  </Fade>\n                )\n              }}\n            </Draggable>\n          )\n        })}\n      </ParameterContext.Provider>\n    )\n  },\n)\n\nconst FlowCard = React.memo(\n  forwardRef(\n    (\n      props: {\n        items: Array<Ifunction & { id: string }>\n        dispatch: React.Dispatch<Action>\n      } & ChakraProps,\n      ref,\n    ) => {\n      const { items, dispatch, ...rest } = props\n      return (\n        <Box\n          ref={ref}\n          boxShadow={'base'}\n          padding={1}\n          minHeight='100%'\n          // height='100%'\n          // width={'49%'}\n          // minWidth='48%'\n          // position='relative'\n          backgroundColor='white'\n          display='flex'\n          flexDirection='column'\n          {...rest}\n        >\n          <Flex paddingLeft={2} alignItems='center'>\n            <Heading fontSize='xl' fontStyle='italic' color='unison.purple'>\n              Flow\n            </Heading>\n            <Spacer></Spacer>\n\n            <Fade in={items.length > 0}>\n              <Button\n                color='unison.darkPink'\n                sx={{ '&:hover': { backgroundColor: 'red.50' } }}\n                variant='ghost'\n                leftIcon={<DeleteIcon />}\n                onClick={() => {\n                  dispatch({ type: 'clearFlowCard' })\n                }}\n              >\n                Clear\n              </Button>\n            </Fade>\n\n            <PopoverExplanation label='Flow card explanation' title='Flow card'>\n              <UnorderedList>\n                <ListItem>\n                  Flow is a special view for the flow function (left-to-right\n                  variadic compose). This is a stab at a \"functional Scratch\" to\n                  visually explore function composition.\n                </ListItem>\n              </UnorderedList>\n              <ListItem>\n                Last argument and return type line up vertically to reinforce\n                the pipeline metaphor.\n              </ListItem>\n              <ListItem>\n                JavaScript is executed and shown on the right. There's no type\n                checking in place yet.\n              </ListItem>\n            </PopoverExplanation>\n          </Flex>\n          <Divider marginTop={2}></Divider>\n          <Droppable droppableId='FlowCard'>\n            {(provided, snapshot) => {\n              return (\n                <Box\n                  ref={provided.innerRef}\n                  {...provided.droppableProps}\n                  // minWidth={'50%'}\n                  flex={1}\n                  minHeight='100%'\n                  height='100%'\n                  overflow='auto'\n                  paddingX={2}\n                  paddingY={4}\n                >\n                  <FlowFunctionsList items={items}></FlowFunctionsList>\n                  {provided.placeholder}\n                </Box>\n              )\n            }}\n          </Droppable>\n        </Box>\n      )\n    },\n  ),\n)\n\nexport default FlowCard\n","import * as React from 'react'\nimport { Box, Button, Center, Flex, HStack, ScaleFade } from '@chakra-ui/react'\nimport { StateContext } from '../state'\nimport FlowCard from './FlowCard'\nimport DocsCard from './DocsCard/DocsCard'\nimport { AddIcon } from '@chakra-ui/icons'\nconst { useContext } = React\n\nconst CardHStack = () => {\n  const scrollContainerRef = React.useRef<HTMLDivElement>(null)\n  const flowCardRef = React.useRef<HTMLElement>(null)\n  const [boxShadows, setBoxShadows] = React.useState(0)\n\n  React.useLayoutEffect(() => {\n    const width = flowCardRef.current?.offsetWidth\n    const listener = (e: any) => {\n      if (!width) return\n      const scrollAmount = e.target.scrollLeft\n      const newBoxShadows =\n        scrollAmount < 10 ? -1 : Math.ceil(scrollAmount / (width - 40)) //discount left:40px\n      if (newBoxShadows !== boxShadows) {\n        setBoxShadows(newBoxShadows)\n      }\n    }\n\n    const scrollContainer = scrollContainerRef.current\n    if (scrollContainer) scrollContainer.addEventListener('scroll', listener)\n    return () => {\n      if (scrollContainer) {\n        scrollContainer.removeEventListener('scroll', listener)\n      }\n    }\n  }, [boxShadows])\n  const { state, dispatch } = useContext(StateContext)\n  return (\n    <Flex\n      overflowX='auto'\n      overflowY='hidden'\n      flexGrow={1}\n      height='100%'\n      backgroundColor='purple.50'\n      ref={scrollContainerRef}\n    >\n      <HStack\n        spacing={0}\n        height='100%'\n        //AndyM\n        width={(state.docCards.length + 1) /*(flowCard)*/ * 39 + 'vw'}\n        display='flex'\n        flex-grow={1}\n        position='relative'\n        transition='width 100ms cubic-bezier(0.19, 1, 0.22, 1)'\n      >\n        <FlowCard\n          transition='box-shadow 100ms linear,opacity 75ms linear,transform 200ms cubic-bezier(0.19, 1, 0.22, 1);'\n          ref={flowCardRef}\n          items={state.flowCardFunctions}\n          dispatch={dispatch}\n          //AndyM\n          // transition='box-shadow 100ms linear,opacity 75ms linear,transform 200ms cubic-bezier(0.19, 1, 0.22, 1);'\n          flexShrink={0}\n          width='39vw'\n          // maxWidth='625px'\n          top='0px'\n          position='sticky'\n          flexGrow={1}\n          overflowY='auto'\n          borderLeft='1px solid rgba(0,0,0,0.05)'\n          left={'0px'}\n        ></FlowCard>\n        {state.docCards.length > 0 ? (\n          state.docCardsNavigationType === 'history' ? (\n            <DocsCard\n              index={state.docCardsSelectedIndex}\n              func={(() => {\n                const doc = state.docCards[state.docCardsSelectedIndex]\n                return doc.type === 'editing'\n                  ? state.functions.find(f => f.name === doc.fnName)\n                  : undefined\n              })()}\n              dispatch={dispatch}\n              functions={state.functions}\n              navigationType={'history'}\n              //AndyM\n              transition='box-shadow 100ms linear,opacity 75ms linear,transform 200ms cubic-bezier(0.19, 1, 0.22, 1);'\n              flexShrink={0}\n              width='39vw'\n              // maxWidth='625px'\n              top='0px'\n              position='sticky'\n              flexGrow={1}\n              overflowY='auto'\n              borderLeft='1px solid rgba(0,0,0,0.05)'\n              left={40 + 'px'}\n            />\n          ) : (\n            state.docCards.map((doc, i) => {\n              const func =\n                doc.type === 'editing'\n                  ? state.functions.find(f => f.name === doc.fnName)\n                  : undefined\n              return (\n                <DocsCard\n                  key={i}\n                  index={i}\n                  func={func}\n                  dispatch={dispatch}\n                  functions={state.functions}\n                  navigationType={\n                    i === 0 ? state.docCardsNavigationType : undefined\n                  }\n                  //AndyM\n                  transition='box-shadow 100ms linear,opacity 75ms linear,transform 200ms cubic-bezier(0.19, 1, 0.22, 1);'\n                  flexShrink={0}\n                  width='39vw'\n                  // maxWidth='625px'\n                  top='0px'\n                  position='sticky'\n                  flexGrow={1}\n                  overflowY='auto'\n                  borderLeft='1px solid rgba(0,0,0,0.05)'\n                  left={(i + 1) * 40 + 'px'}\n                  boxShadow={\n                    i < boxShadows\n                      ? '0px 0px 15px 3px rgba(0,0,0,0.1)'\n                      : '0px 0px 15px 3px rgba(0,0,0,0)'\n                  }\n                />\n              )\n            })\n          )\n        ) : (\n          <Box width='39vw' flexGrow={1} flexShrink={0}>\n            <Center>\n              <ScaleFade in={true}>\n                <Button\n                  leftIcon={<AddIcon />}\n                  colorScheme='teal'\n                  variant='ghost'\n                  fontSize='xl'\n                  onClick={() => dispatch({ type: 'newDocsCard' })}\n                >\n                  New function\n                </Button>\n              </ScaleFade>\n            </Center>\n          </Box>\n        )}\n      </HStack>\n    </Flex>\n  )\n}\nexport default CardHStack\n","import * as React from 'react'\nimport { DragDropContext } from 'react-beautiful-dnd'\nimport {\n  Box,\n  Button,\n  Center,\n  ScaleFade,\n  useTheme,\n  useToken,\n} from '@chakra-ui/react'\nimport SideBar from './components/Sidebar'\nimport CardHStack from './components/CardHStack'\nimport SplitPane from 'react-split-pane'\nimport FlowCard from './components/FlowCard'\nimport { StateContext, useAppReducer } from './state'\nimport DocsCard from './components/DocsCard/DocsCard'\nimport { matchSorter } from 'match-sorter'\nimport './styles.css'\nimport { HotKeys } from 'react-hotkeys'\nimport { AddIcon } from '@chakra-ui/icons'\n\nexport const App = () => {\n  const [state, dispatch] = useAppReducer()\n  const onDragEnd = React.useCallback(\n    dropResult => {\n      if (\n        //SideBar to FlowCard\n        dropResult.source.droppableId !== 'FlowCard' &&\n        dropResult.destination?.droppableId === 'FlowCard'\n      ) {\n        dispatch({\n          type: 'dropFnFromSideBarOnFlowCard',\n          index: dropResult.destination.index,\n          draggableId: dropResult.draggableId,\n        })\n      } else if (\n        // FlowCard to FlowCard\n        dropResult.source.droppableId === 'FlowCard' &&\n        dropResult.destination?.droppableId === 'FlowCard'\n      ) {\n        dispatch({\n          type: 'dropFnFromFlowCardToFlowCard',\n          sourceIndex: dropResult.source.index,\n          destinationIndex: dropResult.destination.index,\n        })\n      } else if (dropResult.destination?.droppableId === 'DocsCard') {\n        dispatch({\n          type: 'dropFnFromSideBarToDocsCard',\n          draggableId: dropResult.draggableId,\n        })\n      } else {\n        dispatch({ type: 'dropOutside' })\n\n        //Regain focus after dropping outside - TODO does not work if dragged and esc pressed\n        const li: any = document.querySelector(\n          `[id$='${dropResult.draggableId}']`,\n        )\n        if (li) {\n          li.focus()\n        }\n      }\n    },\n    [dispatch],\n  )\n  const sideBarRef = React.useRef()\n  const purple = useToken('colors', 'unison.purple')\n\n  return (\n    <StateContext.Provider value={{ state, dispatch }}>\n      <HotKeys //TODO substitute for mousetrap + useEffect\n        keyMap={{ focusSidebar: ['ctrl+b', 'command+b'] }} //TODO parameterize\n        handlers={{\n          focusSidebar() {\n            let a = sideBarRef as any\n            a.current.focus()\n          },\n        }}\n      >\n        <DragDropContext\n          onDragStart={() => {\n            dispatch({ type: 'isDragging' })\n          }}\n          onDragEnd={onDragEnd}\n        >\n          <SplitPane\n            style={{\n              // overflow: 'auto',\n              height: '100vh',\n              borderTop: `6px solid ${purple}`,\n            }}\n            defaultSize='20%'\n            minSize={100}\n            maxSize={-300}\n            split='vertical'\n            pane2Style={{\n              overflowX: 'auto',\n              // overflow: 'auto',\n            }}\n          >\n            <SideBar\n              ref={sideBarRef}\n              searchValue={state.searchValue}\n              dispatch={dispatch}\n              isAnyItemDragging={state.isSideBarItemDragging}\n              items={[\n                {\n                  nodeId: 'functions',\n                  label: 'Functions',\n                  items: matchSorter(state.functions, state.searchValue, {\n                    keys: ['name'],\n                  }),\n                },\n                {\n                  nodeId: 'types',\n                  label: 'Data Types',\n                  items: matchSorter(state.dataTypes, state.searchValue, {\n                    keys: ['type'],\n                  }),\n                },\n                {\n                  nodeId: 'effects',\n                  label: 'Effects',\n                  items: matchSorter(state.effects, state.searchValue, {\n                    keys: ['name'],\n                  }),\n                },\n              ]}\n            ></SideBar>\n            <CardHStack></CardHStack>\n          </SplitPane>\n        </DragDropContext>\n      </HotKeys>\n    </StateContext.Provider>\n  )\n}\n//\"calc(100vh - 3rem)\"\n","import { ReportHandler } from \"web-vitals\"\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import(\"web-vitals\").then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry)\n      getFID(onPerfEntry)\n      getFCP(onPerfEntry)\n      getLCP(onPerfEntry)\n      getTTFB(onPerfEntry)\n    })\n  }\n}\n\nexport default reportWebVitals\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://cra.link/PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/,\n    ),\n)\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void\n  onUpdate?: (registration: ServiceWorkerRegistration) => void\n}\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            \"This web app is being served cache-first by a service \" +\n              \"worker. To learn more, visit https://cra.link/PWA\",\n          )\n        })\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                \"New content is available and will be used when all \" +\n                  \"tabs for this page are closed. See https://cra.link/PWA.\",\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It is the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log(\"Content is cached for offline use.\")\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch((error) => {\n      console.error(\"Error during service worker registration:\", error)\n    })\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { \"Service-Worker\": \"script\" },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\")\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log(\n        \"No internet connection found. App is running in offline mode.\",\n      )\n    })\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister()\n      })\n      .catch((error) => {\n        console.error(error.message)\n      })\n  }\n}\n","import { extendTheme } from '@chakra-ui/react'\n\nconst purple = '#520066'\n\nexport default extendTheme({\n  styles: {\n    global: {\n      html: {\n        backgroundColor: purple,\n        minWidth: '860px',\n        '*:focus': {\n          outline: 'none !important',\n          boxShadow: 'none !important',\n        },\n      },\n    },\n  },\n  number: 3,\n  bool: false,\n  shadows: {\n    outline: 'none',\n  },\n  colors: {\n    unison: {\n      purple,\n      lightPurple: '#8f228f',\n      aqua: '#3cd6b7',\n      limegreen: '#88cc00',\n      green: '#008f30',\n      yellow: '#ffc41f',\n      orange: '#ff8800',\n      pink: '#ff4756',\n      lightblue: '#00adeb',\n      blue: '#0951e0',\n      darkblue: '#00018f',\n      gray: '#616c77',\n      //derived:\n      darkOrange: '#572E00',\n      darkGreen: '#005C1F',\n      darkPink: '#C4333F',\n    },\n  },\n})\n\n/*\ncolors:\n  - name: 'lightpurple'\n    base: '#8f228f'\n  - name: 'purple'\n    base: '#520066'\n\n  - name: 'aqua'\n    base: '#3cd6b7'\n  - name: 'limegreen'\n    base: '#88cc00'\n  - name: 'green'\n    base: '#008f30'\n\n  - name: 'yellow'\n    base: '#ffc41f'\n  - name: 'orange'\n    base: '#ff8800'\n  - name: 'pink'\n    base: '#ff4756'\n\n  - name: 'lightblue'\n    base: '#00adeb'\n  - name: 'blue'\n    base: '#0951e0'\n  - name: 'darkblue'\n    base: '#00018f'\n\n  - name: 'black'\n    base: 'black'\n  - name: 'white'\n    base: 'white'\n  - name: 'gray'\n    base: '#616c77'\n\n\n      \n@import 'data/colors.yml'; // $colors\n\n$tones: (\n  xxx-dark:  ( mix: 'shade', percentage: 80% ),\n  xx-dark:   ( mix: 'shade', percentage: 55% ),\n  x-dark:    ( mix: 'shade', percentage: 45% ),\n  dark:      ( mix: 'shade', percentage: 20% ),\n  mid:       ( mix: 'tint',  percentage: 20% ),\n  light:     ( mix: 'tint',  percentage: 45% ),\n  x-light:   ( mix: 'tint',  percentage: 60% ),\n  xx-light:  ( mix: 'tint',  percentage: 75% ),\n  xxx-light: ( mix: 'tint',  percentage: 90% )\n);\n\n$UCpalettes: generate-palettes($colors, $tones);\n\n@function palette($name, $tone: 'base') {\n  $palette: map-get($UCpalettes, $name);\n  $color: map-get($palette, $tone);\n  @return $color;\n}\n*/\n","import * as React from 'react'\nimport ReactDOM from 'react-dom'\nimport { ColorModeScript, extendTheme, ChakraProvider } from '@chakra-ui/react'\nimport { App } from './App'\nimport reportWebVitals from './reportWebVitals'\nimport * as serviceWorker from './serviceWorker'\nimport theme from './theme'\n\nReactDOM.render(\n  <React.StrictMode>\n    <ColorModeScript />\n    <ChakraProvider theme={theme}>\n      <App />\n    </ChakraProvider>\n  </React.StrictMode>,\n  document.getElementById('root'),\n)\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://cra.link/PWA\nserviceWorker.unregister()\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals()\n","import * as React from 'react'\nimport { Code, CodeProps, TextProps, useTheme } from '@chakra-ui/react'\nimport { Itype } from './interfaces'\n\nconst TypeBadge = ({\n  typeAsString,\n  // fontSize,\n  as,\n  children,\n  rounded,\n}: {\n  typeAsString: Itype['type']\n  // fontSize?: CodeProps['fontSize']\n  as?: CodeProps['as']\n  rounded?: CodeProps['rounded']\n  children?: any\n}) => {\n  // const {\n  //   colors: {\n  //     unison: { orange, yellow },\n  //   },\n  // } = useTheme()\n\n  return (\n    <Code\n      as={as}\n      // fontSize={fontSize}\n      // paddingX={1}\n      // paddingY={0.5}\n      sx={\n        {\n          string: { color: 'unison.darkOrange', backgroundColor: 'yellow.100' },\n          number: {\n            color: 'unison.darkGreen',\n            backgroundColor: 'green.100',\n          },\n          boolean: { color: 'unison.pink', backgroundColor: 'pink.100' },\n          function: { color: 'unison.purple', backgroundColor: 'purple.100' },\n          object: { color: 'black', backgroundColor: 'gray.100' },\n          array: { color: 'black', backgroundColor: 'gray.100' },\n          undefined: { color: 'black', backgroundColor: 'gray.100' },\n          null: { color: 'black', backgroundColor: 'gray.100' },\n        }[typeAsString]\n      }\n      rounded={rounded ?? 'base'}\n    >\n      {children ?? typeAsString}\n    </Code>\n  )\n}\n\nexport default TypeBadge\n","import * as React from 'react'\nimport {\n  Fade,\n  Button,\n  Box,\n  Switch,\n  IconButton,\n  HStack,\n  ListItem,\n  UnorderedList,\n  Text,\n  Link,\n} from '@chakra-ui/react'\nimport {\n  ArrowUpDownIcon,\n  CheckIcon,\n  ChevronLeftIcon,\n  ChevronRightIcon,\n  CloseIcon,\n  DeleteIcon,\n} from '@chakra-ui/icons'\nimport PopoverExplanation from '../PopoverExplanation'\nimport TypeBadge from '../TypeBadge'\nimport { Itype } from '../interfaces'\nimport { FunctionItem } from '../Sidebar'\nimport { GoVersions } from 'react-icons/go'\nimport { Action, StateContext } from '../../state'\nconst { useContext } = React\n\nexport const SaveButton = ({\n  onClick,\n  fadeIn,\n  disabled,\n}: {\n  onClick: () => void\n  fadeIn: boolean\n  disabled: boolean\n}) =>\n  fadeIn ? (\n    <Fade in={true}>\n      {/* Save button */}\n      <Button\n        color={disabled ? 'gray.300' : 'unison.green'}\n        sx={{ '&:hover': { backgroundColor: 'green.50' } }}\n        variant='ghost'\n        leftIcon={<CheckIcon />}\n        disabled={disabled}\n        onClick={onClick}\n      >\n        Save\n      </Button>\n    </Fade>\n  ) : null\n\nexport const ClearButton = ({\n  onClick,\n  fadeIn,\n}: {\n  onClick: () => void\n  fadeIn: boolean\n}) =>\n  fadeIn ? (\n    <Fade in={true}>\n      <Button\n        color='unison.darkPink'\n        sx={{ '&:hover': { backgroundColor: 'red.50' } }}\n        variant='ghost'\n        leftIcon={<DeleteIcon />}\n        onClick={onClick}\n      >\n        Clear\n      </Button>\n    </Fade>\n  ) : null\n\nexport const DocsExplanation = () => (\n  <PopoverExplanation label='Docs card explanation' title='Docs card'>\n    <UnorderedList>\n      <ListItem>\n        Docs is an editable view of the documentation for a function.\n      </ListItem>\n      <ListItem>\n        The signature input will autocomplete types (string/boolean/number so\n        far) and arrows but won't prevent invalid states, which will disable the\n        \"Save\" button.{' '}\n      </ListItem>\n      <ListItem>\n        The description can reference other functions with \"@\" (triggers\n        autocomplete) and navigate to them by clicking on the link. We could\n        imagine adding tests and examples here.\n      </ListItem>\n      <ListItem>Navigation can be </ListItem>\n      <UnorderedList styleType='none'>\n        <ListItem>\n          <ArrowUpDownIcon\n            size={'xs'}\n            sx={{ transform: 'rotate(90deg)' }}\n          ></ArrowUpDownIcon>{' '}\n          browser history style\n        </ListItem>\n        <ListItem>\n          <GoVersions\n            style={{ width: '16px', height: '16px', display: 'inline' }}\n          ></GoVersions>{' '}\n          panes style (like\n          <Link\n            href='https://notes.andymatuschak.org/About_these_notes'\n            color='unison.purple'\n            _hover={{ color: 'unison.lightPurple' }}\n          >\n            {' '}\n            Andy Matuschak's notes\n          </Link>\n          )\n        </ListItem>\n      </UnorderedList>\n    </UnorderedList>\n  </PopoverExplanation>\n)\n\nexport const TypeSuggestionList = ({\n  typeSuggestions,\n  selectedIndex,\n  left,\n  top,\n}: {\n  typeSuggestions: {\n    title: Itype['type']\n  }[]\n  selectedIndex: number\n  left: number\n  top: number\n}) => (\n  <Box\n    as='ul'\n    position='fixed'\n    left={left}\n    top={top}\n    listStyleType='none'\n    padding={1}\n    boxShadow='lg'\n    backgroundColor='white'\n    rounded='sm'\n    zIndex={1000}\n  >\n    {typeSuggestions.map((s, i) => (\n      <Box\n        as='li'\n        key={s.title}\n        display='block'\n        textAlign='center'\n        paddingX={1}\n        paddingY={1}\n        backgroundColor={\n          i === selectedIndex\n            ? 'unison.aqua'\n            : s.title === 'string'\n            ? 'yellow.100'\n            : s.title === 'number'\n            ? 'green.100'\n            : s.title === 'boolean'\n            ? 'pink.100'\n            : 'white'\n        }\n      >\n        <TypeBadge rounded={'none'} typeAsString={s.title}>\n          {s.title}\n        </TypeBadge>\n      </Box>\n    ))}\n  </Box>\n)\n\nexport const FunctionSuggestionList = ({\n  functionSuggestions,\n  selectedIndex,\n  left,\n  top,\n  onClick,\n}: {\n  functionSuggestions: {\n    name: string\n  }[]\n  selectedIndex: number\n  left: number\n  top: number\n  onClick: (index: number) => void\n}) => (\n  <Box\n    as='ul'\n    position='fixed'\n    left={left}\n    top={top}\n    listStyleType='none'\n    padding={1}\n    boxShadow='lg'\n    backgroundColor='white'\n    rounded='sm'\n    zIndex={1000}\n  >\n    {functionSuggestions.map((s, i) => (\n      <Box\n        onClick={() => onClick(i)}\n        as='li'\n        key={s.name}\n        display='block'\n        textAlign='center'\n        paddingX={1}\n        paddingY={1}\n        backgroundColor={i === selectedIndex ? 'unison.aqua' : 'white'}\n        rounded={'base'}\n      >\n        {s.name}\n      </Box>\n    ))}\n  </Box>\n)\n\nexport const DocsNavigationTypeSelector = ({\n  navigationType,\n  dispatch,\n}: {\n  navigationType: 'history' | 'panes'\n  dispatch: React.Dispatch<Action>\n}) => {\n  return (\n    <IconButton\n      onClick={() => {\n        dispatch({\n          type: 'changeNavigationType',\n          navigationType: navigationType === 'history' ? 'panes' : 'history',\n        })\n      }}\n      variant='ghost'\n      sx={{\n        color: 'unison.purple',\n        '&:hover': {\n          color: 'unison.aqua',\n        },\n      }}\n      aria-label='Change navigation type'\n      size='md'\n      icon={\n        navigationType === 'panes' ? (\n          <ArrowUpDownIcon\n            sx={{ transform: 'rotate(90deg)' }}\n          ></ArrowUpDownIcon>\n        ) : (\n          <GoVersions></GoVersions>\n        )\n      }\n    ></IconButton>\n\n    /* <Switch\n        size='sm'\n        isChecked={navigationType === 'panes'}\n        marginX={1}\n        onChange={() => {\n          dispatch({\n            type: 'changeNavigationType',\n            navigationType: navigationType === 'history' ? 'panes' : 'history',\n          })\n        }}\n      ></Switch> */\n  )\n}\n\nconst getButtonStyles = (isDisabled: boolean) => ({\n  variant: 'ghost',\n  sx: isDisabled\n    ? {\n        color: 'grey.300',\n      }\n    : {\n        color: 'unison.purple',\n        '&:hover': {\n          color: 'unison.aqua',\n        },\n      },\n})\n\nexport const DocsNavigationArrows = () => {\n  const { state, dispatch } = useContext(StateContext)\n  const size = '6'\n  const backDisabled = state.docCardsSelectedIndex === 0\n  const forwardDisabled =\n    state.docCardsSelectedIndex === state.docCards.length - 1\n  return (\n    <HStack>\n      <IconButton\n        onClick={() => {\n          dispatch({\n            type: 'docsNavigate',\n            to: 'back',\n          })\n        }}\n        aria-label='Navigate back'\n        {...getButtonStyles(backDisabled)}\n        disabled={backDisabled}\n        icon={<ChevronLeftIcon w={size} h={size}></ChevronLeftIcon>}\n      ></IconButton>\n\n      <IconButton\n        margin={0}\n        onClick={() => {\n          dispatch({\n            type: 'docsNavigate',\n            to: 'forwards',\n          })\n        }}\n        disabled={forwardDisabled}\n        aria-label='Navigate forwads'\n        {...getButtonStyles(forwardDisabled)}\n        icon={<ChevronRightIcon w={size} h={size}></ChevronRightIcon>}\n      ></IconButton>\n    </HStack>\n  )\n}\n","import produce from 'immer'\nimport * as React from 'react'\nimport { v4 as uuid } from 'uuid'\nimport { Ifunction, Ieffect, Itype } from './components/interfaces'\nimport DocsCard from './components/DocsCard/DocsCard'\n\ntype Reducer<A, B> = (a: A, b: B) => A\n\n/* See https://github.com/jefflombard/use-reducer-logger */\nconst getCurrentTimeFormatted = () => {\n  const currentTime = new Date()\n  const hours = currentTime.getHours()\n  const minutes = currentTime.getMinutes()\n  const seconds = currentTime.getSeconds()\n  const milliseconds = currentTime.getMilliseconds()\n  return `${hours}:${minutes}:${seconds}.${milliseconds}`\n}\nconst useLoggerReducer = <A, B extends { type: string | number }>(\n  reducer: Reducer<A, B>,\n  initialState: A,\n) => {\n  const reducerWithLogger = React.useCallback(\n    (state: A, action: B): A => {\n      const next = reducer(state, action)\n      console.group(\n        `%cAction: %c${action.type} %cat ${getCurrentTimeFormatted()}`,\n        'color: lightgreen; font-weight: bold;',\n        'color: white; font-weight: bold;',\n        'color: lightblue; font-weight: lighter;',\n      )\n      console.log(\n        '%cPrevious State:',\n        'color: #9E9E9E; font-weight: 700;',\n        state,\n      )\n      console.log('%cAction:', 'color: #00A7F7; font-weight: 700;', action)\n      console.log('%cNext State:', 'color: #47B04B; font-weight: 700;', next)\n      console.groupEnd()\n      return next\n    },\n    [reducer],\n  )\n\n  return React.useReducer(reducerWithLogger, initialState)\n}\n\nconst initialFunctions: Array<Ifunction> = [\n  {\n    name: 'add',\n    parameters: [{ type: 'number' }, { type: 'number' }],\n    returns: { type: 'number' },\n    fn: function add(x: any, y: any) {\n      return x + y\n    },\n    description: 'Adds two numbers.',\n  },\n  {\n    name: 'example',\n    parameters: [{ type: 'boolean' }, { type: 'number' }, { type: 'string' }],\n    returns: { type: 'string' },\n    fn: function add(x: any, y: any, z: any) {\n      return 'Hi!'\n    },\n    description: 'Example function with a link to @not.',\n  },\n  {\n    name: 'greaterThan',\n    parameters: [{ type: 'number' }, { type: 'number' }],\n    returns: { type: 'boolean' },\n    fn: function greaterThan(n: number, m: number) {\n      return m > n\n    },\n    description:\n      'Returns true number is greater than another number, false otherwise',\n  },\n  {\n    name: 'length',\n    parameters: [{ type: 'string' }],\n    returns: { type: 'number' },\n    fn: function length(s: any) {\n      return s.length\n    },\n    description: 'Takes a string and returns how many characters it has',\n  },\n  {\n    name: 'not',\n    parameters: [{ type: 'boolean' }],\n    returns: { type: 'boolean' },\n    fn: function not(x: any) {\n      return !x\n    },\n    description: 'Negates a boolean value.',\n  },\n  {\n    name: 'upperCase',\n    parameters: [{ type: 'string' }],\n    returns: { type: 'string' },\n    fn: function (s: any) {\n      return s.toUpperCase()\n    },\n    description:\n      'Takes a string and returns it with all characters in uppercase',\n  },\n]\nconst initialDataTypes: Array<Itype> = [\n  { type: 'string' },\n  { type: 'number' },\n  { type: 'boolean' },\n]\nconst initialEffects: Array<Ieffect> = []\n\nexport type Action =\n  | { type: 'isDragging' }\n  | { type: 'createFunction'; function: Ifunction; index: number }\n  | { type: 'dropOutside' }\n  | { type: 'dropFnFromSideBarOnFlowCard'; index: number; draggableId: string }\n  | {\n      type: 'dropFnFromFlowCardToFlowCard'\n      sourceIndex: number\n      destinationIndex: number\n    }\n  | { type: 'clearFlowCard' }\n  | { type: 'sideBarSearch'; value: string }\n  | { type: 'dropFnFromSideBarToDocsCard'; draggableId: string }\n  | { type: 'openDocs'; fnName: string; openerIndex: number }\n  | { type: 'closeDocsCard'; index: number }\n  | { type: 'clearDocsCard'; index: number }\n  | { type: 'newDocsCard' }\n  | { type: 'changeNavigationType'; navigationType: NavigationType }\n  | { type: 'docsNavigate'; to: 'forwards' | 'back' }\n// | {\n//     type: 'changeFunctionParamValue'\n//     paramValue: string | number | boolean\n//     paramIndex: number\n//     functionId: string\n//   }\nexport type NavigationType = 'history' | 'panes'\ntype DocsType = { type: 'creating' } | { type: 'editing'; fnName: string }\n\ntype State = {\n  functions: Ifunction[]\n  dataTypes: Itype[]\n  effects: Ieffect[]\n  isSideBarItemDragging: boolean\n  flowCardFunctions: Array<Ifunction & { id: string }>\n  docCardsNavigationType: NavigationType\n  docCardsSelectedIndex: number\n  docCards: Array<DocsType>\n  searchValue: string\n}\n\nconst initialState: State = {\n  functions: initialFunctions,\n  dataTypes: initialDataTypes,\n  effects: initialEffects,\n  isSideBarItemDragging: false,\n  flowCardFunctions: [],\n  docCardsNavigationType: 'panes',\n  docCardsSelectedIndex: 0,\n  docCards: [\n    { type: 'creating' },\n    // { type: 'editing', fnName: 'example' }\n  ],\n  searchValue: '',\n}\n\nconst reorder = (list: any[], startIndex: number, endIndex: number) => {\n  const listCopy = [...list]\n  const [removed] = listCopy.splice(startIndex, 1)\n  listCopy.splice(endIndex, 0, removed)\n  return listCopy\n}\nconst insert = <A>(list: Array<A>, index: number, item: A) => {\n  const listCopy = [...list]\n  listCopy.splice(index, 0, item)\n  return listCopy\n}\n\nconst changeAtIndex = <A>(list: Array<A>, index: number, item: A) => {\n  const listCopy = [...list]\n  listCopy.splice(index, 1, item)\n  return listCopy\n}\n\nconst getDefaultValue = (p: Itype) => {\n  return p.type === 'string'\n    ? ''\n    : p.type === 'number'\n    ? 0\n    : p.type === 'boolean'\n    ? false\n    : p.type === 'object'\n    ? ''\n    : p.type === 'undefined'\n    ? undefined\n    : p.type === 'null'\n    ? undefined\n    : ''\n}\nconst findFunction = ({\n  state,\n  name,\n  id,\n}: {\n  state: State\n  name: string\n  id: string\n}) => {\n  const fn = state.functions.find(f => f.name === name) as Ifunction\n  const parameters = fn.parameters.map(p => {\n    const value = getDefaultValue(p)\n    return {\n      ...p,\n      value,\n    }\n  })\n  const returns = { ...fn.returns, value: getDefaultValue(fn.returns) }\n  return { ...fn, parameters, returns, id }\n}\n\n// return {\n//   ...state,\n//   isSideBarItemDragging: false,\n//   flowCardFunctions: insert(state.flowCardFunctions, action.index, {\n//     name: action.draggableId.split('_')[1],\n//     id: uuid(),\n//   }),\n// }\n\n// export const fnSelector = (state: State) => ({\n//   name,\n//   id,\n// }: {\n//   name: string\n//   id: string\n// }) => {\n//   const fn = state.functions.find(f => f.name === name) as Ifunction\n//   return { ...fn, id }\n// }\n\nconst incrementWithinBounds = (i: number, as: any[]) =>\n  i === as.length - 1 ? i : i + 1\nconst decrementPositiveNumber = (i: number) => (i === 0 ? i : i - 1)\n\nfunction reducer(state: State, action: Action): State {\n  switch (action.type) {\n    case 'isDragging':\n      return { ...state, isSideBarItemDragging: true }\n    case 'createFunction':\n      const fnIndex = state.functions.findIndex(\n        f => f.name === action.function.name,\n      )\n      return fnIndex === -1\n        ? {\n            ...state,\n            functions: state.functions\n              .concat(action.function)\n              .sort((a, b) => a.name.localeCompare(b.name)),\n            docCards: changeAtIndex(state.docCards, action.index, {\n              type: 'editing',\n              fnName: action.function.name,\n            }),\n          }\n        : {\n            ...state,\n            functions: changeAtIndex(state.functions, fnIndex, action.function),\n          }\n    case 'dropOutside':\n      return { ...state, isSideBarItemDragging: false }\n    case 'dropFnFromSideBarOnFlowCard':\n      return {\n        ...state,\n        isSideBarItemDragging: false,\n        flowCardFunctions: insert(\n          state.flowCardFunctions,\n          action.index,\n          findFunction({\n            state,\n            name: action.draggableId.split('_')[1],\n            id: uuid(),\n          }),\n        ),\n      }\n    case 'dropFnFromFlowCardToFlowCard':\n      return {\n        ...state,\n        isSideBarItemDragging: false,\n        flowCardFunctions: reorder(\n          state.flowCardFunctions,\n          action.sourceIndex,\n          action.destinationIndex,\n        ),\n      }\n    case 'clearFlowCard':\n      return {\n        ...state,\n        flowCardFunctions: [],\n      }\n    case 'sideBarSearch':\n      return {\n        ...state,\n        searchValue: action.value,\n      }\n    case 'dropFnFromSideBarToDocsCard':\n      return {\n        ...state,\n        docCards: [\n          { type: 'editing', fnName: action.draggableId.split('_')[1] },\n        ],\n        docCardsSelectedIndex: 0,\n      }\n    case 'openDocs': {\n      if (\n        /*fn doesn't exist*/\n        !state.functions.find(f => f.name === action.fnName) ??\n        /* already open */\n        state.docCards.find(\n          d => d.type === 'editing' && d.fnName === action.fnName,\n        )\n      ) {\n        return state\n      }\n      const docCards = state.docCards.slice(0, action.openerIndex + 1).concat({\n        type: 'editing',\n        fnName: action.fnName,\n      })\n      const docCardsSelectedIndex = incrementWithinBounds(\n        state.docCardsSelectedIndex,\n        docCards,\n      )\n      return {\n        ...state,\n        docCardsSelectedIndex,\n        docCards,\n      }\n    }\n    case 'closeDocsCard': {\n      if (state.docCardsNavigationType === 'history') {\n        return {\n          ...state,\n          docCards: [],\n          docCardsSelectedIndex: 0,\n        }\n      }\n      const docCards = state.docCards.filter((_, i) => i !== action.index)\n      const docCardsSelectedIndex = decrementPositiveNumber(\n        state.docCardsSelectedIndex,\n      )\n      return {\n        ...state,\n        docCards,\n        docCardsSelectedIndex,\n      }\n    }\n    case 'clearDocsCard':\n      return {\n        ...state,\n        docCards: changeAtIndex(state.docCards, action.index, {\n          type: 'creating',\n        }),\n      }\n    case 'newDocsCard':\n      return {\n        ...state,\n        docCards: [{ type: 'creating' }],\n      }\n    case 'changeNavigationType':\n      return {\n        ...state,\n        docCardsNavigationType: action.navigationType,\n        docCardsSelectedIndex: state.docCards.length - 1,\n      }\n    case 'docsNavigate': {\n      const docCardsSelectedIndex =\n        action.to === 'forwards'\n          ? incrementWithinBounds(state.docCardsSelectedIndex, state.docCards)\n          : decrementPositiveNumber(state.docCardsSelectedIndex)\n\n      return {\n        ...state,\n        docCardsSelectedIndex,\n      }\n    }\n  }\n}\n\nexport const StateContext = React.createContext<{\n  state: State\n  dispatch: React.Dispatch<Action>\n}>({ state: initialState, dispatch() {} })\n\nexport const useAppReducer =\n  process.env.NODE_ENV === 'development'\n    ? () => useLoggerReducer(reducer, initialState)\n    : () => React.useReducer(reducer, initialState)\n","import { QuestionIcon, QuestionOutlineIcon } from '@chakra-ui/icons'\nimport {\n  Popover,\n  PopoverTrigger,\n  IconButton,\n  PopoverContent,\n  PopoverArrow,\n  PopoverCloseButton,\n  PopoverBody,\n  PopoverHeader,\n  PopoverBodyProps,\n  Tooltip,\n} from '@chakra-ui/react'\nimport React from 'react'\n\nconst PopoverExplanation = (props: {\n  children: PopoverBodyProps['children']\n  label: string\n  title: string\n}) => {\n  return (\n    <Popover>\n      <PopoverTrigger>\n        <IconButton\n          aria-label={props.label}\n          icon={\n            <Tooltip label={props.label} aria-label={props.label} hasArrow>\n              {/* <QuestionOutlineIcon /> */}\n              <QuestionIcon />\n            </Tooltip>\n          }\n          size='lg'\n          // colorScheme='purple'\n          color='unison.purple'\n          variant='ghost'\n          sx={{\n            '&:hover': {\n              color: 'unison.aqua',\n            },\n          }}\n        />\n      </PopoverTrigger>\n\n      {/* <PopoverContent borderColor='unison.purple'> */}\n      <PopoverContent>\n        <PopoverArrow />\n        <PopoverCloseButton />\n        <PopoverHeader>{props.title}</PopoverHeader>\n        <PopoverBody>{props.children}</PopoverBody>\n      </PopoverContent>\n    </Popover>\n  )\n}\n\nexport default PopoverExplanation\n"],"sourceRoot":""}